#include <bits/stdc++.h>
using namespace std;

class Solution {
public:
    int intersectionSizeTwo(vector<vector<int>>& intervals) {
        sort(intervals.begin(), intervals.end(), [](auto &a, auto &b){
            if(a[1] == b[1]) return a[0] > b[0];
            return a[1] < b[1];
        });

        vector<int> nums;  
        int p1 = -1, p2 = -1;  

        for(auto &in : intervals){
            int l = in[0], r = in[1];

            bool contains_p1 = (p1 >= l && p1 <= r);
            bool contains_p2 = (p2 >= l && p2 <= r);

            if(contains_p1 && contains_p2) {
                continue;
            }
            else if(contains_p1 || contains_p2) {
                int newPoint = r;
                if(newPoint == p1 || newPoint == p2) newPoint--; 
                nums.push_back(newPoint);

                p2 = p1;
                p1 = newPoint;
            }
            else {
                nums.push_back(r-1);
                nums.push_back(r);
                p2 = r-1;
                p1 = r;
            }
        }

        return nums.size();
    }
};
